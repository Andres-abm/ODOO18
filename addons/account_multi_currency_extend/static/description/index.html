<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Account Multi Currency Extend - Documentation</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #714B67;
            border-bottom: 3px solid #714B67;
            padding-bottom: 15px;
            font-size: 2.5em;
            margin-top: 0;
        }
        h2 {
            color: #875A7B;
            margin-top: 30px;
            font-size: 1.8em;
            border-left: 4px solid #875A7B;
            padding-left: 15px;
        }
        h3 {
            color: #666;
            margin-top: 20px;
            font-size: 1.3em;
        }
        .feature-box {
            background: #f9f9f9;
            border-left: 4px solid #875A7B;
            padding: 20px;
            margin: 20px 0;
            border-radius: 4px;
        }
        .feature-list {
            list-style: none;
            padding: 0;
        }
        .feature-list li {
            padding: 10px 0;
            padding-left: 30px;
            position: relative;
        }
        .feature-list li:before {
            content: "‚úì";
            position: absolute;
            left: 0;
            color: #875A7B;
            font-weight: bold;
            font-size: 1.2em;
        }
        .info-box {
            background: #e8f4f8;
            border: 1px solid #b8dde8;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }
        .warning-box {
            background: #fff3cd;
            border: 1px solid #ffc107;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }
        .code-block {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 4px;
            overflow-x: auto;
            margin: 20px 0;
        }
        .screenshot-placeholder {
            background: #e9ecef;
            border: 2px dashed #adb5bd;
            padding: 60px;
            text-align: center;
            margin: 20px 0;
            border-radius: 4px;
            color: #6c757d;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #875A7B;
            color: white;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        .badge {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 3px;
            font-size: 0.85em;
            font-weight: bold;
            margin: 5px 5px 5px 0;
        }
        .badge-version {
            background: #875A7B;
            color: white;
        }
        .badge-category {
            background: #17a2b8;
            color: white;
        }
        .badge-license {
            background: #28a745;
            color: white;
        }
        .installation-steps {
            counter-reset: step-counter;
            list-style: none;
            padding-left: 0;
        }
        .installation-steps li {
            counter-increment: step-counter;
            padding: 15px;
            margin: 10px 0;
            background: #f8f9fa;
            border-left: 4px solid #875A7B;
            position: relative;
            padding-left: 60px;
        }
        .installation-steps li:before {
            content: counter(step-counter);
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            background: #875A7B;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
        .author-info {
            background: linear-gradient(135deg, #875A7B 0%, #714B67 100%);
            color: white;
            padding: 20px;
            border-radius: 4px;
            margin: 30px 0;
        }
        .field-description {
            margin: 10px 0;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 4px;
        }
        .field-name {
            font-weight: bold;
            color: #875A7B;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìä Account Multi Currency Extend</h1>
        
        <div style="margin: 20px 0;">
            <span class="badge badge-version">Odoo 18.0</span>
            <span class="badge badge-category">Accounting</span>
            <span class="badge badge-license">OPL-1</span>
        </div>

        <div class="feature-box">
            <h3>Module Overview</h3>
            <p><strong>Account Multi Currency Extend</strong> is a powerful Odoo module that enables companies to track and manage transactions in a second currency alongside the company's primary currency. This module is essential for businesses operating in multi-currency environments, particularly in regions where financial reporting requires dual currency tracking.</p>
        </div>

        <h2>üéØ Key Features</h2>
        <ul class="feature-list">
            <li><strong>Dual Currency Tracking</strong> - Track all accounting transactions in both company currency and a second reporting currency</li>
            <li><strong>Automatic Exchange Calculations</strong> - Automatic conversion of debit/credit amounts to the second currency using real-time exchange rates</li>
            <li><strong>Journal Entry Enhancement</strong> - Extended journal entry lines with exchange amount fields (debit_exchange, credit_exchange, exchange_amount)</li>
            <li><strong>Company-Level Configuration</strong> - Enable second currency tracking at the company level with flexible settings</li>
            <li><strong>Dynamic Column Visibility</strong> - Exchange currency columns automatically show/hide based on company configuration</li>
            <li><strong>Multi-Company Support</strong> - Full support for multi-company environments with independent currency settings</li>
            <li><strong>Trial Balance Ready</strong> - Exchange columns designed for enhanced trial balance reporting</li>
            <li><strong>Smart Currency Handling</strong> - Intelligent handling when transaction currency matches the second currency</li>
            <li><strong>Tax Group Validation</strong> - Additional validation to ensure tax groups match tax country settings</li>
        </ul>

        <h2>üìã Technical Specifications</h2>
        
        <h3>Module Information</h3>
        <table>
            <tr>
                <th>Property</th>
                <th>Value</th>
            </tr>
            <tr>
                <td>Module Name</td>
                <td>account_multi_currency_extend</td>
            </tr>
            <tr>
                <td>Version</td>
                <td>18.0</td>
            </tr>
            <tr>
                <td>Author</td>
                <td>Bn Technologies</td>
            </tr>
            <tr>
                <td>Category</td>
                <td>Accounting/Accounting</td>
            </tr>
            <tr>
                <td>License</td>
                <td>OPL-1 (Odoo Proprietary License)</td>
            </tr>
            <tr>
                <td>Dependencies</td>
                <td>base, account, sale</td>
            </tr>
            <tr>
                <td>Auto Install</td>
                <td>True</td>
            </tr>
        </table>

        <h3>Extended Models</h3>
        <div class="info-box">
            <p><strong>This module extends the following Odoo models:</strong></p>
            <ul>
                <li><code>account.move</code> - Journal Entries</li>
                <li><code>account.move.line</code> - Journal Entry Lines</li>
                <li><code>account.tax</code> - Tax Configuration</li>
                <li><code>res.company</code> - Company Settings</li>
                <li><code>res.config.settings</code> - Accounting Settings</li>
            </ul>
        </div>

        <h2>‚öôÔ∏è Installation</h2>
        <ol class="installation-steps">
            <li>Download the module and extract it to your Odoo addons directory</li>
            <li>Restart your Odoo server to load the new module</li>
            <li>Navigate to <strong>Apps</strong> menu and update the apps list</li>
            <li>Search for "Account Multi Currency Extend"</li>
            <li>Click <strong>Install</strong> button</li>
        </ol>

        <div class="warning-box">
            <strong>‚ö†Ô∏è Important:</strong> This module is set to auto-install. Ensure you have the required dependencies (base, account, sale) installed before activating this module.
        </div>

        <h2>üîß Configuration</h2>
        
        <h3>Enable Second Currency</h3>
        <ol class="installation-steps">
            <li>Navigate to <strong>Settings ‚Üí Companies ‚Üí Update Company</strong></li>
            <li>Enable the checkbox <strong>"Enable Second Currency"</strong></li>
            <li>Select your desired second currency from the dropdown</li>
            <li>Save the configuration</li>
        </ol>

        <h3>Alternative Configuration Path</h3>
        <ol class="installation-steps">
            <li>Go to <strong>Accounting ‚Üí Configuration ‚Üí Settings</strong></li>
            <li>Scroll to the <strong>"Second Currency"</strong> section</li>
            <li>Select your second currency</li>
            <li>Click <strong>Save</strong></li>
        </ol>

        <div class="info-box">
            <strong>üí° Tip:</strong> The second currency configuration is company-specific. In multi-company environments, each company can have its own second currency setting.
        </div>

        <h2>üìä New Fields Reference</h2>

        <h3>Company Level Fields (res.company)</h3>
        <div class="field-description">
            <div class="field-name">enable_second_currency_for_company</div>
            <div>Type: Boolean</div>
            <div>Description: Master switch to enable/disable second currency tracking for the company</div>
        </div>

        <div class="field-description">
            <div class="field-name">second_currency_id</div>
            <div>Type: Many2one (res.currency)</div>
            <div>Description: The second currency to be used for exchange calculations</div>
        </div>

        <h3>Journal Entry Fields (account.move)</h3>
        <div class="field-description">
            <div class="field-name">enable_second_currency_for_company</div>
            <div>Type: Boolean (Related field)</div>
            <div>Description: Related to company's second currency enable status</div>
        </div>

        <div class="field-description">
            <div class="field-name">company_second_currency_id</div>
            <div>Type: Many2one (Related field)</div>
            <div>Description: Related to company's second currency</div>
        </div>

        <h3>Journal Entry Line Fields (account.move.line)</h3>
        <div class="field-description">
            <div class="field-name">exchange_currency</div>
            <div>Type: Many2one (res.currency)</div>
            <div>Description: The second currency used for exchange calculations (related to company's second currency)</div>
        </div>

        <div class="field-description">
            <div class="field-name">exchange_amount</div>
            <div>Type: Monetary</div>
            <div>Description: The balance amount (debit - credit) converted to the second currency</div>
            <div>Computation: Automatically calculated based on debit, credit, and exchange rates</div>
        </div>

        <div class="field-description">
            <div class="field-name">debit_exchange</div>
            <div>Type: Monetary</div>
            <div>Description: Debit amount in the second currency</div>
            <div>Computation: Positive value of exchange_amount</div>
        </div>

        <div class="field-description">
            <div class="field-name">credit_exchange</div>
            <div>Type: Monetary</div>
            <div>Description: Credit amount in the second currency</div>
            <div>Computation: Absolute value of negative exchange_amount</div>
        </div>

        <h2>üé® User Interface Enhancements</h2>

        <h3>Journal Entry Form View</h3>
        <ul class="feature-list">
            <li>New columns for exchange_amount, debit_exchange, and credit_exchange in journal entry lines</li>
            <li>Automatic column visibility based on second currency configuration</li>
            <li>Sum totals for all exchange fields at the bottom of the journal entry</li>
            <li>Reordered currency fields for better usability</li>
        </ul>

        <h3>Journal Entry Lines Tree View</h3>
        <ul class="feature-list">
            <li>Exchange fields available in the account.move.line tree view</li>
            <li>Optional visibility for exchange columns</li>
            <li>Total sum calculations for exchange amounts</li>
        </ul>

        <h3>Company Configuration</h3>
        <ul class="feature-list">
            <li>Simple checkbox to enable/disable second currency</li>
            <li>Currency selector with no-create and no-open options for better UX</li>
            <li>Required validation when second currency is enabled</li>
        </ul>

        <h2>üíº Business Use Cases</h2>

        <div class="feature-box">
            <h3>1. Multi-National Corporations</h3>
            <p>Companies operating in countries with unstable currencies can track all transactions in both local currency and a stable reference currency (e.g., USD or EUR) for better financial analysis.</p>
        </div>

        <div class="feature-box">
            <h3>2. Regulatory Compliance</h3>
            <p>Some jurisdictions require businesses to maintain accounting records in multiple currencies. This module helps meet such regulatory requirements automatically.</p>
        </div>

        <div class="feature-box">
            <h3>3. Financial Reporting</h3>
            <p>Generate trial balances and financial statements showing both currencies side-by-side for comprehensive financial analysis and stakeholder reporting.</p>
        </div>

        <div class="feature-box">
            <h3>4. Exchange Rate Analysis</h3>
            <p>Track exchange rate impacts on financial performance by comparing transactions in both currencies over time.</p>
        </div>

        <h2>üîÑ How It Works</h2>

        <h3>Exchange Amount Calculation Logic</h3>
        <div class="info-box">
            <p><strong>The module uses intelligent currency conversion:</strong></p>
            <ol>
                <li><strong>Currency Match Detection:</strong> If the transaction currency already matches the second currency, it uses the amount_currency directly</li>
                <li><strong>Balance Conversion:</strong> Otherwise, it calculates the balance (debit - credit) in company currency and converts it to the second currency</li>
                <li><strong>Date-Based Rates:</strong> Uses the transaction date for exchange rate lookup, ensuring accurate historical conversions</li>
                <li><strong>Automatic Debit/Credit Split:</strong> Automatically splits the exchange_amount into debit_exchange or credit_exchange based on the sign</li>
            </ol>
        </div>

        <h3>Field Dependencies</h3>
        <div class="code-block">
@api.depends('debit', 'credit', 'currency_id', 'amount_currency', 
             'company_id.second_currency_id', 'company_id.currency_id')
def _compute_exchange_amount(self):
    # Calculates exchange_amount based on:
    # - Transaction debit and credit
    # - Transaction currency
    # - Company currency
    # - Second currency configuration
    # - Transaction date for exchange rates
        </div>

        <h2>‚ú® Additional Features</h2>

        <h3>Tax Group Validation</h3>
        <div class="info-box">
            <p>The module includes enhanced validation for tax configurations to ensure data integrity:</p>
            <ul>
                <li>Validates that tax groups have the same country as the taxes using them</li>
                <li>Prevents configuration errors that could lead to reporting issues</li>
                <li>Provides clear error messages when validation fails</li>
            </ul>
        </div>

        <h3>Enhanced Invoice Date Handling</h3>
        <ul class="feature-list">
            <li>Improved invoice date field with future date warnings</li>
            <li>Dynamic required attribute based on move type</li>
            <li>Better visibility control for different document types</li>
        </ul>

        <h2>üìù Technical Notes</h2>

        <div class="warning-box">
            <strong>Performance Considerations:</strong>
            <ul>
                <li>All exchange fields are stored in the database (store=True) for better query performance</li>
                <li>Fields use precompute=True for efficient calculation on new records</li>
                <li>Computed fields have readonly=False to allow manual adjustments if needed</li>
            </ul>
        </div>

        <div class="info-box">
            <strong>Database Impact:</strong>
            <ul>
                <li>Adds 4 new fields to account.move.line table</li>
                <li>Adds 2 new fields to res.company table</li>
                <li>All fields are properly indexed for optimal performance</li>
            </ul>
        </div>

        <h2>üêõ Troubleshooting</h2>

        <h3>Exchange Columns Not Visible</h3>
        <div class="feature-box">
            <p><strong>Solution:</strong> Ensure "Enable Second Currency" is checked in company settings and a second currency is selected.</p>
        </div>

        <h3>Exchange Amounts Not Calculating</h3>
        <div class="feature-box">
            <p><strong>Solution:</strong> Check that currency exchange rates are configured in Accounting ‚Üí Configuration ‚Üí Currencies ‚Üí Rates</p>
        </div>

        <h3>Tax Group Validation Error</h3>
        <div class="feature-box">
            <p><strong>Solution:</strong> Ensure tax groups and taxes have matching country configurations. Go to Accounting ‚Üí Configuration ‚Üí Taxes and verify country settings.</p>
        </div>

        <h2>üîê Security & Permissions</h2>
        <div class="info-box">
            <p>This module respects all standard Odoo accounting security groups:</p>
            <ul>
                <li>Only users with accounting access rights can configure second currency</li>
                <li>Multi-company access rules are automatically applied</li>
                <li>Currency exchange fields follow the same access rights as standard accounting fields</li>
            </ul>
        </div>

        <h2>üîÑ Compatibility</h2>
        <table>
            <tr>
                <th>Component</th>
                <th>Compatibility</th>
            </tr>
            <tr>
                <td>Odoo Version</td>
                <td>18.0 (Community & Enterprise)</td>
            </tr>
            <tr>
                <td>Multi-Company</td>
                <td>‚úÖ Fully Supported</td>
            </tr>
            <tr>
                <td>Multi-Currency</td>
                <td>‚úÖ Enhanced Support</td>
            </tr>
            <tr>
                <td>Accounting Localization</td>
                <td>‚úÖ Compatible with all localizations</td>
            </tr>
        </table>

        <h2>üìö Support & Documentation</h2>
        <div class="info-box">
            <p>For additional support, customization requests, or bug reports, please contact:</p>
            <ul>
                <li><strong>Author:</strong> Bn Technologies</li>
                <li><strong>Module Version:</strong> 18.0</li>
                <li><strong>License:</strong> OPL-1 (Odoo Proprietary License)</li>
            </ul>
        </div>

        <h2>üéì Best Practices</h2>
        <ul class="feature-list">
            <li><strong>Exchange Rate Updates:</strong> Keep your currency exchange rates up to date for accurate conversions</li>
            <li><strong>Historical Accuracy:</strong> Avoid changing the second currency after transactions are posted</li>
            <li><strong>Backup Before Configuration:</strong> Always backup your database before enabling second currency on production systems</li>
            <li><strong>Testing:</strong> Test the module thoroughly in a staging environment before production deployment</li>
            <li><strong>Training:</strong> Train your accounting team on the new fields and their purpose</li>
        </ul>

        <h2>üìà Future Enhancements</h2>
        <div class="feature-box">
            <p>Planned features for future versions:</p>
            <ul>
                <li>Dedicated reports showing side-by-side currency comparison</li>
                <li>Exchange gain/loss calculation and tracking</li>
                <li>Historical exchange rate analysis</li>
                <li>Multi-currency trial balance report</li>
                <li>Dashboard widgets for currency tracking</li>
            </ul>
        </div>

        <div style="text-align: center; margin-top: 40px; padding-top: 20px; border-top: 1px solid #ddd; color: #666;">
            <p>Account Multi Currency Extend ¬© 2025 Bn Technologies | Version 18.0 | OPL-1 License</p>
            <p style="font-size: 0.9em;">Designed for Odoo 18.0 | Professional Accounting Solution</p>
        </div>
    </div>
</body>
</html>